{"version":3,"sources":["webpack:///./src/components/main/ToDo/ToVote.vue","webpack:///src/components/main/ToDo/ToVote.vue","webpack:///./src/components/main/ToDo/ToVote.vue?411d","webpack:///./src/components/main/ToDo/ToVote.vue?635d","webpack:///./src/components/main/ToDo/ToVote.vue?2ac1"],"names":["render","_vm","this","_c","_self","_v","staticClass","attrs","_l","topic","item","key","topicId","padding","margin","staticStyle","_s","topicName","on","$event","toVote","getVoteResult","VoteDialogVisible","temptopicName","options","index","optionId","model","value","radio","callback","$$v","expression","getOption","optionDec","slot","VoteSubmit","VoteResultVisible","sum","tableRowClassName","staticRenderFns","data","temptopicid","methods","rowIndex","ELEMENT","mounted","component"],"mappings":"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","file":"js/chunk-5904d16b.3cbae8c4.js","sourcesContent":["var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',[_c('div',[_vm._v(\"投票列表\")]),_c('el-row',{staticClass:\"row1\",attrs:{\"type\":\"flex\"}},_vm._l((_vm.topic),function(item){return _c('el-col',{key:item.topicId,attrs:{\"span\":4}},[_c('el-card',{attrs:{\"body-style\":{ padding: '1px', margin: '1px' }}},[_c('img',{staticClass:\"image\",attrs:{\"src\":\"https://api.dujin.org/pic/fengjing\"}}),_c('div',{staticStyle:{\"padding\":\"0px\"}},[_c('span',{staticClass:\"topsize\"},[_vm._v(_vm._s(item.topicName))]),_c('div',{staticClass:\"bottom clearfix\"},[_c('el-button',{staticClass:\"button\",attrs:{\"type\":\"text\"},on:{\"click\":function($event){return _vm.toVote(item)}}},[_vm._v(\"投票\")]),_c('el-button',{staticClass:\"button2\",attrs:{\"type\":\"text\"},on:{\"click\":function($event){return _vm.getVoteResult(item)}}},[_vm._v(\"查看投票结果\")])],1)])])],1)}),1),_c('el-dialog',{attrs:{\"visible\":_vm.VoteDialogVisible,\"width\":\"300px\",\"center\":\"\",\"title\":_vm.temptopicName},on:{\"update:visible\":function($event){_vm.VoteDialogVisible=$event}}},[_vm._l((_vm.options),function(item,index){return _c('div',{key:item.optionId,staticClass:\"optdiv\"},[_c('el-radio',{staticClass:\"radioSty\",attrs:{\"label\":item.optionId},model:{value:(_vm.radio),callback:function ($$v) {_vm.radio=$$v},expression:\"radio\"}},[_vm._v(_vm._s(_vm.getOption(index) + \". \" + item.optionDec))])],1)}),_c('span',{staticClass:\"dialog-footer\",attrs:{\"slot\":\"footer\"},slot:\"footer\"},[_c('el-button',{on:{\"click\":function($event){_vm.VoteDialogVisible = false}}},[_vm._v(\"取 消\")]),_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":_vm.VoteSubmit}},[_vm._v(\"确 定\")])],1)],2),_c('el-dialog',{attrs:{\"visible\":_vm.VoteResultVisible,\"width\":\"400px\",\"center\":\"\",\"title\":_vm.temptopicName},on:{\"update:visible\":function($event){_vm.VoteResultVisible=$event}}},[_c('el-table',{staticStyle:{\"width\":\"100%\"},attrs:{\"data\":_vm.sum,\"row-class-name\":_vm.tableRowClassName}},[_c('el-table-column',{attrs:{\"prop\":\"optionDec\",\"label\":\"选项\",\"width\":\"170\"}}),_c('el-table-column',{attrs:{\"prop\":\"optionSum\",\"label\":\"投票人数\",\"width\":\"170\"}})],1),_c('span',{staticClass:\"dialog-footer\",attrs:{\"slot\":\"footer\"},slot:\"footer\"},[_c('el-button',{on:{\"click\":function($event){_vm.VoteResultVisible = false}}},[_vm._v(\"关 闭\")])],1)],1)],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<!-- eslint-disable vue/no-unused-vars -->\r\n<template>\r\n  <div>\r\n    <div>投票列表</div>\r\n    <el-row class=\"row1\" type=\"flex\">\r\n      <el-col v-for=\"item in topic\" :key=\"item.topicId\" :span=\"4\">\r\n        <el-card :body-style=\"{ padding: '1px', margin: '1px' }\">\r\n          <img src=\"https://api.dujin.org/pic/fengjing\" class=\"image\" />\r\n          <div style=\"padding: 0px\">\r\n            <span class=\"topsize\">{{ item.topicName }}</span>\r\n            <div class=\"bottom clearfix\">\r\n              <el-button type=\"text\" class=\"button\" @click=\"toVote(item)\"\r\n                >投票</el-button\r\n              >\r\n              <el-button\r\n                type=\"text\"\r\n                class=\"button2\"\r\n                @click=\"getVoteResult(item)\"\r\n                >查看投票结果</el-button\r\n              >\r\n            </div>\r\n          </div>\r\n        </el-card>\r\n      </el-col>\r\n    </el-row>\r\n    <el-dialog\r\n      :visible.sync=\"VoteDialogVisible\"\r\n      width=\"300px\"\r\n      center\r\n      :title=\"temptopicName\"\r\n    >\r\n      <!-- index + item.optionDec -->\r\n      <div v-for=\"(item, index) in options\" :key=\"item.optionId\" class=\"optdiv\">\r\n        <el-radio v-model=\"radio\" :label=\"item.optionId\" class=\"radioSty\">{{\r\n          getOption(index) + \". \" + item.optionDec\r\n        }}</el-radio>\r\n      </div>\r\n      <span slot=\"footer\" class=\"dialog-footer\">\r\n        <el-button @click=\"VoteDialogVisible = false\">取 消</el-button>\r\n        <el-button type=\"primary\" @click=\"VoteSubmit\">确 定</el-button>\r\n      </span>\r\n    </el-dialog>\r\n\r\n    <el-dialog\r\n      :visible.sync=\"VoteResultVisible\"\r\n      width=\"400px\"\r\n      center\r\n      :title=\"temptopicName\"\r\n    >\r\n      <!-- index + item.optionDec -->\r\n      <el-table\r\n        :data=\"sum\"\r\n        style=\"width: 100%\"\r\n        :row-class-name=\"tableRowClassName\"\r\n      >\r\n        <el-table-column prop=\"optionDec\" label=\"选项\" width=\"170\">\r\n        </el-table-column>\r\n        <el-table-column prop=\"optionSum\" label=\"投票人数\" width=\"170\">\r\n        </el-table-column>\r\n      </el-table>\r\n      <span slot=\"footer\" class=\"dialog-footer\">\r\n        <el-button @click=\"VoteResultVisible = false\">关 闭</el-button>\r\n      </span>\r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport topicApi from \"@/api/Topic.js\";\r\n\r\nexport default {\r\n  data() {\r\n    return {\r\n      // 投票对话框\r\n      VoteDialogVisible: false,\r\n      //投票结果\r\n      VoteResultVisible: false,\r\n      // 临时标题中间键\r\n      temptopicName: \"\",\r\n      // 投票话题中间件\r\n      temptopicid: '',\r\n      topic: [],\r\n      // 选项数据\r\n      options: [],\r\n      // 投票选项对应的id\r\n      radio: \"\",\r\n      sum:[],\r\n      \r\n    };\r\n  },\r\n  methods: {\r\n    tableRowClassName({rowIndex}) {\r\n        if (rowIndex === 1) {\r\n          return 'warning-row';\r\n        } else if (rowIndex === 3) {\r\n          return 'success-row';\r\n        }\r\n        return '';\r\n      },\r\n    // 点击投票\r\n    async toVote(topic) {\r\n      // 设置临时id\r\n      this.temptopicid = topic.topicId\r\n      //获取是否已经投票数据\r\n      const isvotedata = await topicApi.checkIsVote(topic.topicId);\r\n      if(isvotedata.data.isvote){\r\n        return ELEMENT.Message.info(\"已经投过票了！\");\r\n      }\r\n      \r\n      console.log(this.isVote);\r\n  \r\n      // 调试打印topic对象\r\n      console.log(topic);\r\n      // 设置对话框标题\r\n      this.temptopicName = topic.topicName;\r\n      // 弹出对话框\r\n      this.VoteDialogVisible = true;\r\n\r\n      // 获取数据\r\n      const data = await topicApi.getoptions(topic.topicId);\r\n      this.options = data.data.optionList;\r\n    },\r\n\r\n     //获取投票结果\r\n    async getVoteResult(topic){\r\n      this.VoteResultVisible=true;\r\n      this.show=true;\r\n      const data = await topicApi.getVoteResult(topic.topicId);\r\n      if (data.code != 1) {\r\n        return this.$message.error(\"获取数据失败\");\r\n      }\r\n      this.sum = data.data.optionTableList\r\n    },\r\n\r\n\r\n    // 获取所有标题\r\n    async getTitleList() {\r\n      const data = await topicApi.getTopic();\r\n      if (data.code != 1) {\r\n        return ELEMENT.Message.error(\"获取数据失败\");\r\n      }\r\n      this.topic = data.data.topic;\r\n      ELEMENT.Message.success(\"获取数据成功\");\r\n    },\r\n\r\n    // 确认投票\r\n    async VoteSubmit() {\r\n      // 打印投票对应id\r\n      //console.log(this.radio)\r\n\r\n      if(this.radio!=''){\r\n        const data = await topicApi.toVoteById(this.radio,this.temptopicid);\r\n      if (data.code == 1) {\r\n        ELEMENT.Message.success(\"投票成功\");\r\n      }\r\n      }else{\r\n        return ELEMENT.Message.error(\"没有选择投票选项\");\r\n      }\r\n       \r\n      this.VoteDialogVisible = !this.VoteDialogVisible;\r\n    },\r\n    // 遍历获取ABCD选项\r\n    getOption(index) {\r\n      const arr = [\r\n        \"A\",\r\n        \"B\",\r\n        \"C\",\r\n        \"D\",\r\n        \"E\",\r\n        \"F\",\r\n        \"G\",\r\n        \"H\",\r\n        \"I\",\r\n        \"J\",\r\n        \"K\",\r\n        \"L\",\r\n        \"M\",\r\n        \"N\",\r\n        \"O\",\r\n        \"P\",\r\n        \"Q\",\r\n        \"R\",\r\n        \"S\",\r\n        \"T\",\r\n        \"U\",\r\n        \"V\",\r\n        \"W\",\r\n        \"X\",\r\n        \"Y\",\r\n        \"Z\",\r\n      ];\r\n      return arr[index];\r\n    },\r\n  },\r\n\r\n  // 加载页面后执行\r\n  mounted() {\r\n    this.getTitleList();\r\n  },\r\n};\r\n</script>\r\n\r\n<style scope lang=\"less\">\r\n.topsize {\r\n  font-size: 5px;\r\n}\r\n\r\n.bottom {\r\n  margin-top: 13px;\r\n  line-height: 12px;\r\n}\r\n\r\n.button {\r\n  padding: 0;\r\n  float: right;\r\n}\r\n\r\n.button2 {\r\n  padding: 0;\r\n  float: left;\r\n}\r\n\r\n.image {\r\n  width: 100%;\r\n  display: block;\r\n}\r\n\r\n.clearfix:before,\r\n.clearfix:after {\r\n  display: table;\r\n  content: \"\";\r\n}\r\n\r\n.clearfix:after {\r\n  clear: both;\r\n}\r\n.row1 {\r\n  flex-wrap: wrap;\r\n}\r\n\r\n.optdiv {\r\n  margin: 3px;\r\n  .radioSty {\r\n    font-size: 20px;\r\n  }\r\n}\r\n.el-table .warning-row {\r\n    background: oldlace;\r\n  }\r\n\r\n  .el-table .success-row {\r\n    background: #f0f9eb;\r\n  }\r\n</style>\r\n","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ToVote.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ToVote.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./ToVote.vue?vue&type=template&id=de6acaa2&\"\nimport script from \"./ToVote.vue?vue&type=script&lang=js&\"\nexport * from \"./ToVote.vue?vue&type=script&lang=js&\"\nimport style0 from \"./ToVote.vue?vue&type=style&index=0&id=de6acaa2&prod&scope=true&lang=less&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--11-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--11-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--11-oneOf-1-2!../../../../node_modules/less-loader/dist/cjs.js??ref--11-oneOf-1-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ToVote.vue?vue&type=style&index=0&id=de6acaa2&prod&scope=true&lang=less&\""],"sourceRoot":""}